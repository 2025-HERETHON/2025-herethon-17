<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!--템플릿 규칙 적용으로 templates 폴더 아래 posts 폴더 생성-->
</head>
<body>
    <!--상단에 검색 폼 띄우기-->
    <form method="GET" action="{% url 'posts:search' %}">
        <input type="text" name="q" placeholder="검색어를 입력하세요">
        <button type="submit">검색</button>
    </form>

    <!--로그인했을 때만 로그아웃, 마이페이지 링크 띄움-->
    {% if request.user.is_authenticated %}
    <!--post 말고 현재 로그인한 request로 닉네임 출력--> 
    {{ request.user.username }} 환영 <br>
    <a href="{% url 'users:logout' %}">로그아웃</a><br>
    <a href="{% url 'users:mypage' %}">마이페이지</a><br> 
    {% endif %}

    <form method="GET" action="{% url 'posts:index' %}">
        <select name="category">
            <option value="">모든 카테고리</option>
            {% for category in categories %}
            <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
        </select>
        <input type="submit" value="조회" />
    </form>
    <br>
    
    <a href="{% url 'posts:create' %}">글쓰기!</a><br><br>

<!-- 카테고리별 최신순 5개 글 띄우기 -->
    {% for item in category_posts %}
    <h2>{{ item.category.name }}</h2>
        <span><a href="{% url 'posts:category' item.category.id %}">더보기</a><span><br>
        {% for post in item.posts %}
            <a href="{% url 'posts:detail' post.id %}">{{ post.title }}</a>
            <span>조회수 : {{ post.views }}</span><br><br>
        {% empty %}
            아직 작성된 글이 없어요!
        {% endfor %}
    {% endfor %}

</body>
</html>